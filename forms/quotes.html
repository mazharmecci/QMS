<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QMS - Quotes</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #f5f7fa;
      margin: 0;
    }

    header {
      background: #0d6efd;
      color: #fff;
      padding: 0.75rem 1.5rem;
    }

    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .back-btn {
      border: none;
      background: rgba(255,255,255,0.12);
      color: #fff;
      padding: 0.45rem 0.9rem;
      border-radius: 999px;
      cursor: pointer;
    }

    .header-title {
      flex: 1;
      text-align: center;
      font-weight: 600;
      font-size: 1.5rem;
    }

    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 2rem;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    /* SALES QUOTATION HEADER BLOCK */

    .quote-header {
      margin-bottom: 2rem;
      border: 1px solid #ccc;
      border-radius: 12px;
      background: #fff;
      padding: 1.5rem;
    }

    .quote-header-top {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 1rem;
    }

    .logo-box img {
      height: 60px;
      object-fit: contain;
    }

    .quote-header-body {
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
    }

    .quote-left {
      flex: 1;
      min-width: 300px;
    }

    .quote-right {
      flex: 1;
      min-width: 300px;
      background: #f0f0f0;
      padding: 1rem 1.25rem;
      border-radius: 8px;
    }

    .company-box {
      background: #e9ecef;
      padding: 1rem 1.25rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      font-size: 0.95rem;
      line-height: 1.4;
    }

    .company-box p {
      margin: 0;
    }

    .hospital-box,
    .attn-box {
      margin-bottom: 1rem;
      font-size: 0.95rem;
      line-height: 1.4;
    }

    .hospital-box p,
    .attn-box p,
    .quote-right p {
      margin: 0 0 0.35rem;
    }

    .quote-right p strong {
      font-weight: 600;
    }

    .quote-right-title {
      text-align: left;
      font-weight: 700;
      margin-bottom: 0.75rem;
      letter-spacing: 0.05em;
    }

    /* SIMPLE FORM FIELDS BELOW (FOR NOW JUST TO SHOW HOW DATA FLOWS) */

    .quote-meta-fields {
      margin-top: 1.5rem;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
    }

    .quote-meta-fields input,
    .quote-meta-fields select {
      padding: 0.5rem 0.6rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 0.9rem;
    }

  </style>
</head>
<body>
<header>
  <div class="header-inner">
    <button type="button" class="back-btn" onclick="goBack()">‚Üê Back</button>
    <div class="header-title">QMS - Quotes</div>
  </div>
</header>

<div class="container">

  <!-- SALES QUOTATION HEADER (UI-FOCUSED SECTION) -->
  <div class="quote-header">
    <div class="quote-header-top">
      <div class="logo-box">
        <!-- Use your logo path here -->
        <img src="images/logo.png" alt="ISTOS Logo">
      </div>
    </div>

    <div class="quote-header-body">
      <!-- LEFT SIDE: COMPANY + HOSPITAL + ATTN -->
      <div class="quote-left">
        <div class="company-box">
          <p>
            <strong>ISTOS Medical Pvt Ltd.</strong><br>
            #51/5, 2nd Cross, J.C. Ind Area,<br>
            Bikasipura Main Road, Yelachenahalli,<br>
            Bangalore - 560062
          </p>
        </div>

        <div class="hospital-box">
          <p>
            <strong>To:</strong><br>
            <span id="toHospitalName">Hospital / Client Name</span><br>
            <span id="toHospitalAddress">Hospital Address</span>
          </p>
        </div>

        <div class="attn-box">
          <p>
            <strong>Kind Attn:</strong>
            <span id="toAttn">Contact Person</span>
          </p>
        </div>
      </div>

      <!-- RIGHT SIDE: SALES QUOTATION METADATA -->
      <div class="quote-right">
        <p class="quote-right-title">SALES QUOTATION</p>
        <p><strong>Quote No:</strong> <span id="metaQuoteNo">EQ/SQ/25-26/00001</span></p>
        <p><strong>Quotation Date:</strong> <span id="metaQuoteDate">dd-mm-yyyy</span></p>
        <p><strong>Reference Date:</strong> <span id="metaRefDate">dd-mm-yyyy</span></p>
        <p><strong>Contact Person:</strong> <span id="metaContactPerson">Contact Person</span></p>
        <p><strong>Phone:</strong> <span id="metaPhone">Phone</span></p>
        <p><strong>Email:</strong> <span id="metaEmail">Email</span></p>
      </div>
    </div>

    <!-- SUPPORTING INPUTS TO DRIVE THE HEADER (WE WILL HOOK THEM TO BUILDER LATER) -->
    <div class="quote-meta-fields" style="margin-top:1.5rem;">
      <select id="hospitalSelect" onchange="populateHospitalDetails()">
        <option value="">Select Hospital</option>
      </select>
      <input type="text" id="quoteNo" placeholder="Quote No. (auto)">
      <input type="date" id="quoteDate">
      <input type="date" id="refDate">
      <input type="text" id="hospitalName" placeholder="Hospital / Client Name">
      <input type="text" id="hospitalAddress" placeholder="Hospital Address">
      <input type="text" id="contactPerson" placeholder="Contact Person">
      <input type="text" id="contactPhone" placeholder="Contact Phone">
      <input type="email" id="contactEmail" placeholder="Contact Email">
    </div>
  </div>

  <!-- NEXT SECTIONS (QUOTE BUILDER, SUMMARY, ETC.) WILL GO BELOW THIS LATER -->

</div>

<script>
  function goBack() {
    if (window.history.length > 1) {
      window.history.back();
    }
  }

  function generateQuoteNo() {
    const lastNo = localStorage.getItem('lastQuoteNo') || 'EQ/SQ/25-26/00000';
    const parts = lastNo.split('/');
    const num = parseInt(parts[parts.length - 1], 10) + 1;
    const newNo = `EQ/SQ/25-26/${String(num).padStart(5, '0')}`;
    localStorage.setItem('lastQuoteNo', newNo);
    return newNo;
  }

  function initHeaderDefaults() {
    // Quote no + dates
    const quoteNoInput = document.getElementById('quoteNo');
    if (!quoteNoInput.value) quoteNoInput.value = generateQuoteNo();

    const todayISO = new Date().toISOString().slice(0,10);
    if (!document.getElementById('quoteDate').value) {
      document.getElementById('quoteDate').value = todayISO;
    }
    if (!document.getElementById('refDate').value) {
      document.getElementById('refDate').value = todayISO;
    }

    // Mirror to right-hand metadata display (dd-mm-yyyy format)
    syncHeaderDisplay();
  }

  function formatISOToDMY(iso) {
    if (!iso) return 'dd-mm-yyyy';
    const [y,m,d] = iso.split('-');
    return `${d}-${m}-${y}`;
  }

  function syncHeaderDisplay() {
    const qNo = document.getElementById('quoteNo').value || '';
    const qDateISO = document.getElementById('quoteDate').value || '';
    const rDateISO = document.getElementById('refDate').value || '';
    const hospName = document.getElementById('hospitalName').value || '';
    const hospAddr = document.getElementById('hospitalAddress').value || '';
    const contact = document.getElementById('contactPerson').value || '';
    const phone = document.getElementById('contactPhone').value || '';
    const email = document.getElementById('contactEmail').value || '';

    document.getElementById('metaQuoteNo').textContent = qNo || 'EQ/SQ/25-26/00001';
    document.getElementById('metaQuoteDate').textContent = formatISOToDMY(qDateISO);
    document.getElementById('metaRefDate').textContent = formatISOToDMY(rDateISO);

    document.getElementById('toHospitalName').textContent = hospName || 'Hospital / Client Name';
    document.getElementById('toHospitalAddress').textContent = hospAddr || 'Hospital Address';
    document.getElementById('toAttn').textContent = contact || 'Contact Person';

    document.getElementById('metaContactPerson').textContent = contact || 'Contact Person';
    document.getElementById('metaPhone').textContent = phone || 'Phone';
    document.getElementById('metaEmail').textContent = email || 'Email';
  }

  function populateHospitalDropdown() {
    const hospitals = JSON.parse(localStorage.getItem('hospitals') || '[]');
    const select = document.getElementById('hospitalSelect');
    select.innerHTML = '<option value="">Select Hospital</option>';
    hospitals.forEach((hosp, idx) => {
      const opt = document.createElement('option');
      opt.value = idx;
      opt.textContent = `${hosp.clientCode} - ${hosp.clientName}`;
      select.appendChild(opt);
    });
  }

  function populateHospitalDetails() {
    const hospitals = JSON.parse(localStorage.getItem('hospitals') || '[]');
    const idx = document.getElementById('hospitalSelect').value;
    if (idx === '') return;
    const hosp = hospitals[idx];
    if (!hosp) return;

    document.getElementById('hospitalName').value = hosp.clientName || '';
    document.getElementById('hospitalAddress').value = hosp.address || '';
    document.getElementById('contactPerson').value = '';
    document.getElementById('contactPhone').value = hosp.mobile || '';
    document.getElementById('contactEmail').value = hosp.email || '';

    syncHeaderDisplay();
  }

  // Keep header live-updated when fields change
  ['quoteNo','quoteDate','refDate','hospitalName','hospitalAddress','contactPerson','contactPhone','contactEmail']
    .forEach(id => {
      const el = document.getElementById(id);
      el.addEventListener('input', syncHeaderDisplay);
      el.addEventListener('change', syncHeaderDisplay);
    });

  // Init on load
  initHeaderDefaults();
  populateHospitalDropdown();
</script>
</body>
</html>
