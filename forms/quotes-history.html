<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quote History</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-gradient: radial-gradient(circle at 25% 25%, #3b82f6 0, #3f5a91 40%, #111827 90%);
      --card-bg: #ffffff; /* white container */
      --accent: #3b82f6;
      --accent-soft: rgba(59, 130, 246, 0.12);
      --accent-soft-2: rgba(37, 99, 235, 0.16);
      --error: #f97373;
      --text-main: #0f172a;
      --text-muted: #6b7280;
      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-sm: 8px;
      --shadow-soft: 0 18px 50px rgba(15, 23, 42, 0.35);
      --border-subtle: 1px solid rgba(148, 163, 184, 0.26);
    }
    
/* ===== Base layout ===== */

body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
  color: var(--text-main);
  background: #020617; /* dark base behind gradient */
}

.quotes-gradient {
  position: fixed;
  inset: 0;
  background: var(--bg-gradient);
  opacity: 0.9;
  filter: blur(2px);
  z-index: -2;
}

/* ===== Header (top bar) ‚Äì keep dark/glossy ===== */

header {
  position: sticky;
  top: 0;
  z-index: 20;
  background: rgba(15, 23, 42, 0.95);
  border-bottom: var(--border-subtle);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  color: #e5e7eb;
  box-shadow: 0 12px 28px rgba(15, 23, 42, 0.7);
}

.header-inner {
  max-width: 1320px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 0.7rem 1.5rem;
}

.back-btn {
  border: 1px solid rgba(148, 163, 184, 0.6);
  background: rgba(15, 23, 42, 0.9);
  color: #e5e7eb;
  padding: 0.4rem 0.9rem;
  border-radius: 999px;
  cursor: pointer;
  font-size: 0.8rem;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  transition: all 0.18s ease-out;
  box-shadow: 0 8px 20px rgba(15, 23, 42, 0.7);
}

.back-btn:hover {
  background: rgba(15, 23, 42, 1);
  box-shadow: 0 10px 26px rgba(15, 23, 42, 0.8);
  transform: translateY(-1px);
}

.header-title {
  flex: 1;
  text-align: center;
  font-weight: 600;
  font-size: 1.3rem;
  letter-spacing: 0.04em;
}

/* ===== Main shell + container ===== */

.quotes-shell {
  min-height: calc(100vh - 56px);
  display: flex;
  justify-content: center;
  padding: 24px;
}

.container {
  width: 100%;
  max-width: 100%;    /* allow full expansion */
  margin: 0 auto;
  border-radius: var(--radius-lg);
  background: var(--card-bg); /* white window */
  box-shadow: var(--shadow-soft);
  border: var(--border-subtle);
  padding: 22px 24px 20px;
  color: var(--text-main);
  overflow-x: auto;   /* prevent clipping */
}

/* ===== Section title ===== */

h2 {
  margin: 0 0 1rem 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 1.05rem;
  color: var(--text-main);
}

h2 span {
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 0.7rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  background: var(--accent-soft);
  color: var(--accent);
}

/* ===== Dashboard stats ‚Äì soften to light cards ===== */

.dashboard {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
  gap: 1.1rem;
  margin-bottom: 1.6rem;
}

.stat-card {
  position: relative;
  overflow: hidden;
  text-align: left;
  padding: 0.9rem 1rem;
  background: #f9fafb;
  border-radius: var(--radius-md);
  border: 1px solid rgba(148, 163, 184, 0.4);
  color: var(--text-main);
  box-shadow: 0 10px 24px rgba(15, 23, 42, 0.15);
}

.stat-card::before {
  content: "";
  position: absolute;
  inset: -1px;
  background: radial-gradient(circle at top left, rgba(59, 130, 246, 0.2), transparent 55%);
  opacity: 0.7;
  z-index: -1;
}

.stat-number {
  font-size: 1.7rem;
  font-weight: 600;
  color: var(--accent);
}

.stat-label {
  color: var(--text-muted);
  font-size: 0.84rem;
  margin-top: 0.15rem;
}

/* ===== Controls (filters + actions) ‚Äì light strip ===== */

.controls {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
  align-items: center;
  margin-bottom: 1.25rem;
  padding: 0.9rem;
  border-radius: var(--radius-md);
  background: #f3f4f6;
  border: 1px solid rgba(148, 163, 184, 0.35);
  color: var(--text-main);
}

.controls input,
.controls select {
  padding: 0.45rem 0.8rem;
  border-radius: var(--radius-sm);
  border: 1px solid rgba(148, 163, 184, 0.6);
  background: #ffffff;
  color: var(--text-main);
  font-size: 0.86rem;
}

.controls input::placeholder {
  color: var(--text-muted);
}

.controls input:focus,
.controls select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.4);
}

/* ===== Buttons ===== */

.btn {
  padding: 0.5rem 1rem;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  font-weight: 500;
  font-size: 0.86rem;
  transition: all 0.18s ease-out;
}

.btn-primary {
  background: linear-gradient(135deg, #3b82f6, #6366f1);
  color: #fff;
  box-shadow: 0 10px 20px rgba(37, 99, 235, 0.45);
}

.btn-secondary {
  background: #e5e7eb;
  color: #111827;
  border: 1px solid rgba(148, 163, 184, 0.7);
}

.btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 22px rgba(15, 23, 42, 0.25);
}

/* ===== Table wrapper + table ‚Äì white list area ===== */

.table-wrapper {
  margin: 0 auto;
  border-radius: var(--radius-md);
  border: 1px solid rgba(148, 163, 184, 0.4);
  background: #ffffff;
  padding: 4px 6px;
  color: var(--text-main);
  box-shadow: 0 12px 30px rgba(15, 23, 42, 0.18);
  overflow-x: scroll;   /* enable horizontal scroll */
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch; /* smooth scroll on laptops/touchpads */
}

table { 
  width: max-content; /* table grows to fit all columns */   
  border-collapse: collapse; }

th,
td {
  padding: 0.6rem 1.1rem;
  text-align: left;
  font-size: 0.85rem;
  border-bottom: 1px solid #e5e7eb;
  white-space: nowrap;
}

th {
  background: linear-gradient(to right, #f3f4f6, #e5e7eb);
  font-weight: 600;
  color: #4b5563;
  cursor: pointer;
  user-select: none;
}

tr:nth-child(even) td {
  background: #f9fafb;
}

tr:nth-child(odd) td {
  background: #ffffff;
}

tr:hover td {
  background: #e5f2ff;
}

/* ===== Row actions ===== */

.actions { 
  display: flex; 
  flex-wrap: wrap; /* allow wrapping */ 
  gap: 4px; 
}

td.actions { 
  white-space: normal; /* override nowrap */ 
}
    
.actions button {
  margin-right: 0.3rem;
  margin-bottom: 4px;
  padding: 0.32rem 0.7rem;
  border: none;
  border-radius: 999px;
  cursor: pointer;
  font-size: 0.78rem;
  transition: all 0.16s;
}

.view-btn {
  background: var(--accent-soft-2);
  color: var(--accent);
}

.delete-btn {

  </style>
</head>
<body>
<div class="quotes-gradient"></div>

<header>
  <div class="header-inner">
    <button type="button" class="back-btn" onclick="goBack()">‚Üê Back</button>
    <div class="header-title">ISTOS Medical - Quotes History</div>
  </div>
</header>

<div class="quotes-shell">
  <div class="container">
    <!-- Dashboard -->
    <div class="dashboard">
      <div class="stat-card">
        <div class="stat-number" id="statTotal">0</div>
        <div class="stat-label">Total Quotes</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="statPending">0</div>
        <div class="stat-label">Submitted / Approved</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="statApproved">0</div>
        <div class="stat-label">Approved</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="statApprovalRate">--</div>
        <div class="stat-label">Approval Rate</div>
      </div>
    </div>

    <h2>üìã Saved Quotes</h2>

    <!-- Filters -->
    <div class="controls">
      <input id="filterQuoteNo" placeholder="Quote No...">
      <input id="filterHospital" placeholder="Hospital...">
      <input id="filterStatus" placeholder="Status (Submitted / Approved)">
      <input id="filterDate" type="date">
      <button class="btn btn-secondary" onclick="applyFilters()">Filter</button>
      <button class="btn btn-secondary" onclick="clearFilters()">Clear</button>
      <button class="btn btn-primary" onclick="exportCSV()">Export CSV</button>
    </div>

    <!-- Table centered & widened -->
    <div class="table-wrapper">
      <div id="detailsDiv" class="hidden"></div>
      <table id="quoteTable">
        <thead>
        <tr>
          <th onclick="sortBy('index')">#</th>
          <th onclick="sortBy('quoteNo')">Quote No</th>
          <th onclick="sortBy('date')">Date</th>
          <th onclick="sortBy('hospital')">Hospital</th>
          <th onclick="sortBy('value')">Total Value (INR)</th>
          <th onclick="sortBy('status')">Status</th>
          <th>Created By</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Details -->
    <div id="quoteDetails" class="hidden"></div>
  </div>
</div>

<script type="module">
  import {
    db,
    auth,
    collection,
    getDocs,
    updateDoc,
    deleteDoc,
    doc
  } from "../js/firebase.js";
  import {
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

  const QUOTES_URL = "quotes.html";

  // ===== Auth state =====
  let currentUserUid = null;
  onAuthStateChanged(auth, (user) => {
    currentUserUid = user ? user.uid : null;
  });

  // ===== State =====
  let quotes = [];
  let filteredQuotes = [];
  let sortConfig = { key: null, direction: "asc" };

  const tbody = document.querySelector("#quoteTable tbody");
  const detailsDiv = document.getElementById("quoteDetails");

  function goBack() {
    if (history.length > 1) history.back();
  }

  function moneyINR(value) {
    const num = Number(value || 0);
    return num.toLocaleString("en-IN", {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    });
  }

  function getStatusClass(status) {
    const s = (status || "submitted").toLowerCase();
    return "status-" + s;
  }

  // Map auth UID ‚Üí email prefix
  const USER_UID_TO_PREFIX = {
    "MUkO1OZ2KCfWvvoMHAHcuQm4FjH3": "mazhar",
    "LIvqyOhAUkPpivMXbSK4sIB8I8T2": "s.khan"
  };

  function createdByLabel(createdBy) {
    if (!createdBy) return "-";
    if (USER_UID_TO_PREFIX[createdBy]) return USER_UID_TO_PREFIX[createdBy];
    if (typeof createdBy === "string" && createdBy.includes("@")) {
      return createdBy.split("@")[0];
    }
    return createdBy;
  }

  // ===== Firestore load (base quotes only) =====
  async function loadQuotes() {
    const snap = await getDocs(collection(db, "quoteHistory"));
    quotes = snap.docs.map(d => ({
      id: d.id,
      ...d.data()
    }));
    filteredQuotes = [...quotes];
    renderTable();
  }

  // ===== Helper: load all revisions for a quote =====
  async function loadRevisionsForQuote(quoteId) {
    const revColRef = collection(db, "quoteHistory", quoteId, "revisions");
    const revSnap = await getDocs(revColRef);

    const revisions = revSnap.docs.map(d => ({
      id: d.id,
      ...d.data()
    }));

    return revisions.sort((a, b) => {
      const ra = Number(a.revision || 0);
      const rb = Number(b.revision || 0);
      if (ra && rb && ra !== rb) return ra - rb;

      const ca = a.createdAt?.toMillis ? a.createdAt.toMillis() : 0;
      const cb = b.createdAt?.toMillis ? b.createdAt.toMillis() : 0;
      return ca - cb;
    });
  }

  // ===== Table render =====
  function renderTable(data = filteredQuotes) {
    tbody.innerHTML = "";

    data.forEach((q, i) => {
      const quoteNo   = q.quoteNo || "-";
      const revision  = q.revision || 1;
      const date      = q.quoteDate || "-";
      const hospital  = q.hospital?.name || "-";
      const total     = q.totalValueINR || 0;
      const status    = q.status || "Submitted";
      const creator   = createdByLabel(q.createdBy);

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${i + 1}</td>
        <td>${quoteNo} (Rev ${revision})</td>
        <td>${date}</td>
        <td>${hospital}</td>
        <td>‚Çπ ${moneyINR(total)}</td>
        <td><span class="status-badge ${getStatusClass(status)}">${status}</span></td>
        <td>${creator}</td>
        <td class="actions">
          <button class="view-btn" onclick="viewQuote(${i})">View</button>
          <button class="status-btn" onclick="advanceStatus(${i})">Next</button>
          <button class="view-btn" onclick="editQuote(${i})">Edit</button>
          <button class="delete-btn" onclick="deleteQuote(${i})">Delete</button>
        </td>
      `;
      tbody.appendChild(tr);
    });

    updateDashboard();
  }

  // ===== Dashboard: Submitted / Approved only =====
  function updateDashboard() {
    const total = quotes.length;
    const submittedOrApproved = quotes.filter(q => {
      const s = (q.status || "submitted").toLowerCase();
      return s === "submitted" || s === "approved";
    }).length;
    const approved = quotes.filter(q => (q.status || "").toLowerCase() === "approved").length;
    const approvalRate = submittedOrApproved
      ? Math.round((approved / submittedOrApproved) * 100)
      : 0;

    document.getElementById("statTotal").textContent = total;
    document.getElementById("statPending").textContent = submittedOrApproved;
    document.getElementById("statApproved").textContent = approved;
    document.getElementById("statApprovalRate").textContent =
      submittedOrApproved ? approvalRate + "%" : "--";
  }

  // ===== Filters =====
  function applyFilters() {
    const fQuote    = document.getElementById("filterQuoteNo").value.trim().toLowerCase();
    const fHospital = document.getElementById("filterHospital").value.trim().toLowerCase();
    const fStatus   = document.getElementById("filterStatus").value.trim().toLowerCase();
    const fDate     = document.getElementById("filterDate").value;

    filteredQuotes = quotes.filter(q => {
      const quoteNo  = (q.quoteNo || "").toLowerCase();
      const hospital = (q.hospital?.name || "").toLowerCase();
      const status   = (q.status || "submitted").toLowerCase();
      const date     = q.quoteDate || "";

      return (!fQuote    || quoteNo.includes(fQuote)) &&
             (!fHospital || hospital.includes(fHospital)) &&
             (!fStatus   || status.includes(fStatus)) &&
             (!fDate     || date.startsWith(fDate));
    });

    renderTable(filteredQuotes);
  }

  function clearFilters() {
    document.getElementById("filterQuoteNo").value = "";
    document.getElementById("filterHospital").value = "";
    document.getElementById("filterStatus").value = "";
    document.getElementById("filterDate").value = "";
    filteredQuotes = [...quotes];
    renderTable(filteredQuotes);
  }

  // ===== Sorting =====
  function sortBy(key) {
    if (sortConfig.key === key) {
      sortConfig.direction = sortConfig.direction === "asc" ? "desc" : "asc";
    } else {
      sortConfig.key = key;
      sortConfig.direction = "asc";
    }

    filteredQuotes.sort((a, b) => {
      let av, bv;
      switch (key) {
        case "quoteNo":   av = a.quoteNo   || ""; bv = b.quoteNo   || ""; break;
        case "date":      av = a.quoteDate || ""; bv = b.quoteDate || ""; break;
        case "hospital":  av = a.hospital?.name || ""; bv = b.hospital?.name || ""; break;
        case "value":     av = a.totalValueINR || 0; bv = b.totalValueINR || 0; break;
        case "status":    av = a.status || "Submitted"; bv = b.status || "Submitted"; break;
        default: return 0;
      }

      if (typeof av === "number") {
        return sortConfig.direction === "asc" ? av - bv : bv - av;
      }
      return sortConfig.direction === "asc"
        ? String(av).localeCompare(String(bv))
        : String(bv).localeCompare(String(av));
    });

    renderTable(filteredQuotes);
  }

  // ===== Status advance (Submitted / Approved only) =====
  async function advanceStatus(index) {
    const q = filteredQuotes[index];
    if (!q) return;

    const current = (q.status || "Submitted").toLowerCase();
    const next = current === "submitted" ? "Approved" : "Submitted";

    q.status = next;

    try {
      await updateDoc(doc(db, "quoteHistory", q.id), { status: next });

      const base = quotes.find(x => x.id === q.id);
      if (base) base.status = next;

      renderTable(filteredQuotes);
    } catch (err) {
      console.error("Failed to update status", err);
      alert("Failed to update status");
    }
  }

  // ===== Edit in quotes.html (owner-only) =====
  function editQuote(index) {
    const q = filteredQuotes[index];
    if (!q) return;

    if (!currentUserUid || q.createdBy !== currentUserUid) {
      alert("You can only edit quotes you created.");
      return;
    }

    window.location.href = `${QUOTES_URL}?id=${encodeURIComponent(q.id)}`;
  }

    // ===== Globals =====
    const detailsDiv = document.getElementById("detailsDiv");
    
    // ===== Delete (owner-only) =====
    async function deleteQuote(index) {
      const q = filteredQuotes[index];
      if (!q) return;
    
      // Ownership check
      if (!currentUserUid || q.createdBy !== currentUserUid) {
        alert("You can only delete quotes you created.");
        return;
      }
    
      // Confirm deletion
      if (!confirm("Delete this quote from history?")) return;
    
      try {
        // Delete from Firestore
        await deleteDoc(doc(db, "quoteHistory", q.id));
    
        // Update local arrays
        quotes = quotes.filter(x => x.id !== q.id);
        filteredQuotes = filteredQuotes.filter(x => x.id !== q.id);
    
        // Re-render table
        renderTable(filteredQuotes);
    
        // Hide details panel
        detailsDiv.classList.add("hidden");
      } catch (err) {
        console.error("Failed to delete quote", err);
        alert("Failed to delete quote");
      }
    }
    
    // ===== Detail view (base + revisions) =====
    async function viewQuote(index) {
      const q = filteredQuotes[index];
      if (!q) return;
    
      const items = q.items || [];
      const hosp  = q.hospital || {};
    
      // Load revisions
      let revisions = [];
      try {
        revisions = await loadRevisionsForQuote(q.id);
      } catch (err) {
        console.error("Failed to load revisions", err);
      }
    
      // Build HTML
      let html = `
        <div class="quote-details">
          <h3>Quote Details - ${q.quoteNo || ""}</h3>
          <div class="details-grid">
            <p><strong>Quote No:</strong> ${q.quoteNo || "-"}</p>
            <p><strong>Date:</strong> ${q.quoteDate || "-"}</p>
            <p><strong>Hospital:</strong> ${hosp.name || "-"}</p>
            <p><strong>Status:</strong> <span class="status-badge ${getStatusClass(q.status)}">${q.status || "Submitted"}</span></p>
            <p><strong>Contact:</strong> ${hosp.contactPerson || "-"}</p>
            <p><strong>Phone:</strong> ${hosp.phone || "-"}</p>
            <p><strong>Email:</strong> ${hosp.email || "-"}</p>
            <p><strong>Address:</strong> ${hosp.address || "-"}</p>
          </div>
    
          <h4>Line Items (Latest)</h4>
          <table style="width:100%; border-collapse:collapse; font-size:0.85rem; margin-bottom:1rem;">
            <thead>
              <tr style="background:#f0f4f8;">
                <th>Instrument</th>
                <th>Code</th>
                <th style="text-align:right;">Qty</th>
                <th style="text-align:right;">Unit Price</th>
                <th style="text-align:right;">Total</th>
              </tr>
            </thead>
            <tbody>
      `;
    
      items.forEach(li => {
        html += `
          <tr>
            <td>${li.instrumentName || ""}</td>
            <td>${li.instrumentCode || ""}</td>
            <td style="text-align:right;">${li.quantity || 0}</td>
            <td style="text-align:right;">‚Çπ ${moneyINR(li.unitPrice)}</td>
            <td style="text-align:right;">‚Çπ ${moneyINR(li.totalPrice)}</td>
          </tr>
        `;
      });
    
      html += `
            </tbody>
          </table>
    
          <h4>Summary (Latest)</h4>
          <div class="details-grid">
            <p><strong>GST @ ${items[0]?.gstPercent || q.gstPercent || 0}%:</strong> ‚Çπ ${moneyINR(q.gstValueINR)}</p>
            <p><strong>Total Value:</strong> ‚Çπ ${moneyINR(q.totalValueINR)}</p>
          </div>
    
          <h4>Revisions</h4>
      `;
    
      if (revisions.length) {
        html += `<ul style="margin-top:0.5rem;">`;
        revisions.forEach(r => {
          const revNo = r.revision || "?";
          const revTotal = r.localSummary?.totalValue || r.totalValueINR || 0;
          const createdAt =
            r.createdAt && r.createdAt.toDate
              ? r.createdAt.toDate().toISOString().slice(0, 10)
              : "-";
          html += `
            <li style="margin-bottom:4px;">
              <strong>Rev ${revNo}</strong>
              &nbsp;|&nbsp; Date: ${createdAt}
              &nbsp;|&nbsp; Total: ‚Çπ ${moneyINR(revTotal)}
            </li>
          `;
        });
        html += `</ul>`;
      } else {
        html += `<p>No revision snapshots found.</p>`;
      }
    
      html += `
          <div style="margin-top:1.5rem; text-align:right;">
            <button id="closeDetails" class="btn btn-secondary">Close</button>
          </div>
        </div>
      `;
    
      // Render into detailsDiv
      detailsDiv.innerHTML = html;
      detailsDiv.classList.remove("hidden");
    
      // Wire up close button
      document.getElementById("closeDetails").addEventListener("click", () => {
        detailsDiv.classList.add("hidden");
      });
    }


  // ===== CSV Export =====
  function exportCSV() {
    if (!quotes.length) {
      alert("No quotes to export.");
      return;
    }

    const headerRow = ["Quote No","Date","Hospital","Total Value","Status"];
    const lines = [headerRow.join(",")];

    quotes.forEach(q => {
      const row = [
        `"${(q.quoteNo || "").replace(/"/g, '""')}"`,
        q.quoteDate || "",
        `"${(q.hospital?.name || "").replace(/"/g, '""')}"`,
        q.totalValueINR || 0,
        q.status || "Submitted"
      ];
      lines.push(row.join(","));
    });

    const blob = new Blob([lines.join("\n")], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "quotes-history.csv";
    a.click();
    URL.revokeObjectURL(url);
  }

  // ===== Wire globals =====
  
  window.goBack        = goBack;
  window.applyFilters  = applyFilters;
  window.clearFilters  = clearFilters;
  window.sortBy        = sortBy;
  window.viewQuote     = viewQuote;
  window.advanceStatus = advanceStatus;
  window.deleteQuote   = deleteQuote;
  window.exportCSV     = exportCSV;
  window.editQuote     = editQuote;

  document.getElementById("filterQuoteNo").addEventListener("input", applyFilters);
  document.getElementById("filterHospital").addEventListener("input", applyFilters);
  document.getElementById("filterStatus").addEventListener("input", applyFilters);
  document.getElementById("filterDate").addEventListener("change", applyFilters);

  loadQuotes();
</script>

</body>
</html>
