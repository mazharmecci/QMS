<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QMS - Instruments</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family:'Inter',sans-serif; background:#f5f7fa; margin:0; }
    header { background:#0d6efd; color:#fff; padding:0.75rem 1.5rem; }
    .header-inner { max-width:1200px; margin:0 auto; display:flex; align-items:center; gap:12px; }
    .back-btn { border:none; background:rgba(255,255,255,0.12); color:#fff; padding:0.45rem 0.9rem; border-radius:999px; cursor:pointer; }
    .header-title { flex:1; text-align:center; font-weight:600; font-size:1.5rem; }

    .container { max-width:1200px; margin:2rem auto; padding:2rem; background:#fff; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
    .top-bar { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem; }
    .top-bar h2 { color:#0d6efd; margin:0; }
    .top-bar button { background:#0d6efd; color:#fff; border:none; padding:0.6rem 1rem; border-radius:8px; cursor:pointer; }

    form { display:none; grid-template-columns:1fr 1fr; gap:1rem; margin:1rem 0 2rem; }
    form.active { display:grid; }
    form input, form select, form button, form textarea {
      padding:0.8rem;
      border:1px solid #ccc;
      border-radius:8px;
      font-size:0.95rem;
      font-family:'Inter',sans-serif;
    }
    #description { grid-column:span 2; height:120px; resize:vertical; }
    #suppliedWithInput { grid-column:span 2; height:140px; resize:vertical; }
    form button[type="submit"] { grid-column:span 2; background:#0d6efd; color:#fff; border:none; cursor:pointer; }

    table { width:100%; border-collapse:separate; border-spacing:0 8px; margin-top:1rem; }
    thead th { padding:0.8rem; background:#f0f4f8; border-bottom:1px solid #ddd; text-align:left; }
    tbody tr { background:#fff; box-shadow:0 1px 4px rgba(0,0,0,0.04); }
    td { padding:0.8rem; border-top:1px solid #eee; border-bottom:1px solid #eee; vertical-align:top; }
    tbody tr td:first-child { border-left:1px solid #eee; border-radius:8px 0 0 8px; }
    tbody tr td:last-child { border-right:1px solid #eee; border-radius:0 8px 8px 0; }
    .actions { white-space:nowrap; }
    .actions button { margin-right:0.5rem; padding:0.4rem 0.8rem; border:none; border-radius:6px; cursor:pointer; font-size:0.85rem; }
    .edit-btn { background:#ffc107; }
    .delete-btn { background:#dc3545; color:#fff; }
    .pagination { margin-top:1rem; text-align:center; }
    .pagination button { margin:0 0.5rem; padding:0.4rem 0.8rem; border:none; border-radius:6px; background:#0d6efd; color:#fff; cursor:pointer; }

    .collapse-toggle { cursor:pointer; color:#0d6efd; font-weight:600; font-size:0.9rem; margin-bottom:0.25rem; user-select:none; }
    .details-content { display:none; font-size:0.9rem; margin-top:0.5rem; }
    .price-cell { font-weight:600; white-space:nowrap; }

    .toast-container {
      position:fixed;
      bottom:20px;
      right:20px;
      z-index:2000;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .toast {
      min-width:220px;
      max-width:320px;
      background:#198754;
      color:#fff;
      padding:0.6rem 0.9rem;
      border-radius:6px;
      font-size:13px;
      box-shadow:0 2px 8px rgba(0,0,0,0.2);
      opacity:0;
      transform:translateY(10px);
      transition:opacity 0.25s ease, transform 0.25s ease;
    }
    .toast.show { opacity:1; transform:translateY(0); }
    .toast.error { background:#dc3545; }
  </style>
</head>
<body>
<header>
  <div class="header-inner">
    <button type="button" class="back-btn" onclick="goBack()">← Back</button>
    <div class="header-title">QMS - Instruments</div>
  </div>
</header>

<div id="toastContainer" class="toast-container"></div>

<div class="container">
  <div class="top-bar">
    <h2>Instrument Master</h2>
    <button type="button" onclick="toggleForm()">Add Instrument</button>
  </div>

  <form id="instrumentForm">
    <input type="text" id="instrumentCode" placeholder="Instrument Code (for quotes)">
    <input type="text" id="description" placeholder="Main item name (e.g. pfm Rotary 3005E (Semi-Electronic Microtome))" required>
    <textarea id="mainItemName" placeholder="Instrument description (complete description of the instrument)" rows="2" style="width:100%;"></textarea>    
    <textarea id="suppliedWithInput" rows="8" placeholder="Supplied Complete with (list items). Then a blank line, then Dimensions / Weight / Power."></textarea>
    <input type="text" id="origin" placeholder="Country Of Origin">
    <input type="text" id="catalog" placeholder="Catalog Reference">
    <input type="text" id="hsn" placeholder="HSN Code (1234 5678)" maxlength="9">
    <input type="text" id="unitPrice" placeholder="Basic / Unit Price (₹)">
    <input type="text" id="gstType" placeholder="GST Type">
    <input type="number" id="gstPercent" placeholder="GST %">
    <button type="submit">Save Instrument</button>
  </form>

  <table id="instrumentTable">
    <thead>
      <tr>
        <th>Equip-Name</th>
        <th>Equip-Desc</th>
        <th>Origin</th>
        <th>Catalog</th>
        <th>HSN</th>
        <th>Code</th>
        <th>Price</th>
        <th>GST Type</th>
        <th>GST %</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="pagination">
    <button type="button" onclick="prevPage()">Prev</button>
    <span id="pageInfo"></span>
    <button type="button" onclick="nextPage()">Next</button>
  </div>
</div>

<!-- Page-specific helpers -->
<script>
  function goBack() {
    if (window.history.length > 1) {
      window.history.back();
    } else {
      window.location.href = 'index.html';
    }
  }
  function toggleForm() {
    document.getElementById('instrumentForm').classList.toggle('active');
  }
</script>

<!-- Modules -->
<script type="module" src="../js/firebase.js"></script>
<script type="module" src="../js/instrumentService.js"></script>
<script type="module" src="../js/instrumentUI.js"></script>
</body>
</html>
